import { type NextPage } from "next";
import Head from "next/head";
import axios from "axios";

interface Dog {
  name: string;
  image: string;
}

const getDogs = async (amount: Number) => {
  const savedDogs = [];
  for(let i = 0; i < amount; i++) {
    const image = await axios.get(`https://dog.ceo/api/breeds/image/random`).then(res => res.data.message)
    const name = image.split('/')[4];
    savedDogs.push({ name, image });
  }
  return savedDogs;
}

const Home: NextPage = ({dogs}: any) => {
  let randomDogIndex = Math.floor(Math.random() * dogs.length);
  console.log(dogs);

  const dogSelected = (dog: Dog) => {
    console.log(dog.name);
  }

  return (
    <>
      <Head>
        <title>Create T3 App</title>
        <meta name="description" content="Generated by create-t3-app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className="flex min-h-screen flex-col items-center justify-center bg-gradient-to-b from-[#2e026d] to-[#15162c]">
        <h1 className="text-4xl text-white font-bold">Which dog is the {dogs[randomDogIndex].name}?</h1>
        <div className="flex flex-wrap justify-center">
          {dogs.map((dog:any, index:number) => (
            <div className="flex flex-col items-center justify-center m-4" key={index}>
              {/* <h2 className="text-2xl text-white font-bold">{dog.name}</h2> */}
              <img src={dog.image} className="rounded-md max-h-80 w-80 shadow-xl hover:outline hover:outline-white hover:outline-4" onClick={() => {dogSelected(dog)}}/>
            </div>
          ))}
        </div>
      </main>
    </>
  );
};

export async function getStaticProps() {
  // Instead of fetching your `/api` route you can call the same
  // function directly in `getStaticProps`
  const dogs = await getDogs(4);

  // Props returned will be passed to the page component
  return { props: { dogs } }
}

export default Home;
